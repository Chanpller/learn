# 6章 单行函数

## 6.1 函数理解

DBMS 之间的差异性很大，远大于同一个语言不同版本之间的差异。实际上，只有很少的函数是被 DBMS 同时支持的。比如，大多数 DBMS 使用（||）或者（+）来做拼接符，而在 MySQL 中的字符串拼接函数为concat()

- 操作数据对象
- 接受参数返回一个结果
- 只对一行进行变换
- 每行返回一个结果
- 可以嵌套
- 参数可以是一列或一个值

## 6.2 数值函数

### 6.2.1基本函数

| 函数                | 用法                                                         |
| ------------------- | ------------------------------------------------------------ |
| ABS(x)              | 返回x的绝对值                                                |
| SIGN(X)             | 返回X的符号。正数返回1，负数返回-1，0返回0                   |
| PI()                | 返回圆周率的值                                               |
| CEIL(x)，CEILING(x) | 往大的取，返回最大的整数                                     |
| FLOOR(x)            | 往小的取，返回最小的整数                                     |
| LEAST(e1,e2,e3…)    | 返回列表中的最小值                                           |
| GREATEST(e1,e2,e3…) | 返回列表中的最大值                                           |
| MOD(x,y)            | 返回X除以Y后的余数                                           |
| RAND()              | 返回0~1的随机值                                              |
| RAND(x)             | 返回0~1的随机值，其中x的值用作种子值，相同的X值会产生相同的随机数 |
| ROUND(x)            | 返回一个对x的值进行四舍五入后，最接近于X的整数               |
| ROUND(x,y)          | 返回一个保留X到小数点后面Y位进行四舍五入后最接近X的值        |
| TRUNCATE(x,y)       | 返回数字x截断为y位小数的结果(保留多少位小数，没有的不添加0进行补全) |
| SQRT(x)             | 返回x的平方根。当X的值为负数时，返回NULL                     |

```sql
#ABS(x)返回x的绝对值
mysql> select ABS(-1),ABS(-2.0),ABS(1),ABS(2.0),ABS(0) from DUAL;
+---------+-----------+--------+----------+--------+
| ABS(-1) | ABS(-2.0) | ABS(1) | ABS(2.0) | ABS(0) |
+---------+-----------+--------+----------+--------+
|       1 |       2.0 |      1 |      2.0 |      0 |
+---------+-----------+--------+----------+--------+

#SIGN(X)返回X的符号。正数返回1，负数返回-1，0返回0
mysql> select SIGN(-1),SIGN(-2.0),SIGN(1),SIGN(2.0),SIGN(0) from DUAL;
+----------+------------+---------+-----------+---------+
| SIGN(-1) | SIGN(-2.0) | SIGN(1) | SIGN(2.0) | SIGN(0) |
+----------+------------+---------+-----------+---------+
|       -1 |         -1 |       1 |         1 |       0 |
+----------+------------+---------+-----------+---------+

#PI() 返回圆周率的值
mysql> SELECT PI() FROM DUAL;
+----------+
| PI()     |
+----------+
| 3.141593 |
+----------+

#CEIL(x)，CEILING(x) 返回大于或等于某个值的最小整数
mysql> select CEIL(-1),CEIL(-2.9),CEIL(-2.1),CEIL(1),CEIL(2.1),CEIL(2.9),CEIL(0),CEILING(-1),CEILING(-2.9),CEILING(-2.1),CEILING(1),CEILING(2.1),CEILING(2.9),CEILING(0)from DUAL;
+----------+------------+------------+---------+-----------+-----------+---------+-------------+---------------+---------------+------------+--------------+--------------+------------+
| CEIL(-1) | CEIL(-2.9) | CEIL(-2.1) | CEIL(1) | CEIL(2.1) | CEIL(2.9) | CEIL(0) | CEILING(-1) | CEILING(-2.9) | CEILING(-2.1) | CEILING(1) | CEILING(2.1) | CEILING(2.9) | CEILING(0) |
+----------+------------+------------+---------+-----------+-----------+---------+-------------+---------------+---------------+------------+--------------+--------------+------------+
|       -1 |         -2 |         -2 |       1 |         3 |         3 |       0 |          -1 |            -2 |            -2 |          1 |            3 |            3 |          0 |
+----------+------------+------------+---------+-----------+-----------+---------+-------------+---------------+---------------+------------+--------------+--------------+------------+
#FLOOR(x) 返回小于或等于某个值的最大整数
mysql> select FLOOR(-1),FLOOR(-2.9),FLOOR(-2.1),FLOOR(1),FLOOR(2.1),FLOOR(2.9),FLOOR(0)from DUAL;
+-----------+-------------+-------------+----------+------------+------------+----------+
| FLOOR(-1) | FLOOR(-2.9) | FLOOR(-2.1) | FLOOR(1) | FLOOR(2.1) | FLOOR(2.9) | FLOOR(0) |
+-----------+-------------+-------------+----------+------------+------------+----------+
|        -1 |          -3 |          -3 |        1 |          2 |          2 |        0 |
+-----------+-------------+-------------+----------+------------+------------+----------+
#LEAST(e1,e2,e3…) 返回列表中的最小值
mysql> select LEAST(3,2,5,7,1),LEAST('A','B','C'),LEAST('A','7',3) from DUAL;
+------------------+--------------------+------------------+
| LEAST(3,2,5,7,1) | LEAST('A','B','C') | LEAST('A','7',3) |
+------------------+--------------------+------------------+
|                1 | A                  | 3                |
+------------------+--------------------+------------------+

#GREATEST(e1,e2,e3…) 返回列表中的最大值
mysql> select GREATEST(3,2,5,7,1),GREATEST('A','B','C'),GREATEST('A','7',3) from DUAL;
+---------------------+-----------------------+---------------------+
| GREATEST(3,2,5,7,1) | GREATEST('A','B','C') | GREATEST('A','7',3) |
+---------------------+-----------------------+---------------------+
|                   7 | C                     | A                   |
+---------------------+-----------------------+---------------------+
#MOD(x,y) 返回X除以Y后的余数
mysql> select MOD(7,4),MOD('A',4),MOD('7',4) from DUAL;
+----------+------------+------------+
| MOD(7,4) | MOD('A',4) | MOD('7',4) |
+----------+------------+------------+
|        3 |          0 |          3 |
+----------+------------+------------+

#RAND() 返回0~1的随机值
mysql> select RAND() from DUAL;
+--------------------+
| RAND()             |
+--------------------+
| 0.7335847064234174 |
+--------------------+

#RAND(x)返回0~1的随机值，其中x的值用作种子值，相同的X值会产生相同的随机数
mysql> select RAND(),RAND(3),RAND(3) ,RAND(2)from DUAL;
+--------------------+--------------------+--------------------+--------------------+
| RAND()             | RAND(3)            | RAND(3)            | RAND(2)            |
+--------------------+--------------------+--------------------+--------------------+
| 0.4780346252750928 | 0.9057697559760601 | 0.9057697559760601 | 0.6555866465490187 |
+--------------------+--------------------+--------------------+--------------------+

#ROUND(x) 返回一个对x的值进行四舍五入后，最接近于X的整数
mysql> select ROUND(3),ROUND(1.6),ROUND(1.2),ROUND(0),ROUND(-1.2),ROUND(-1.6),ROUND(-3)from DUAL;
+----------+------------+------------+----------+-------------+-------------+-----------+
| ROUND(3) | ROUND(1.6) | ROUND(1.2) | ROUND(0) | ROUND(-1.2) | ROUND(-1.6) | ROUND(-3) |
+----------+------------+------------+----------+-------------+-------------+-----------+
|        3 |          2 |          1 |        0 |          -1 |          -2 |        -3 |
+----------+------------+------------+----------+-------------+-------------+-----------+
#ROUND(x,y) 返回一个保留X到小数点后面Y位进行四舍五入后最接近X的值
mysql> select ROUND(3.5664,3),ROUND(1.63435,2),ROUND(3,2)from DUAL;
+-----------------+------------------+------------+
| ROUND(3.5664,3) | ROUND(1.63435,2) | ROUND(3,2) |
+-----------------+------------------+------------+
|           3.566 |             1.63 |          3 |
+-----------------+------------------+------------+

#TRUNCATE(x,y) 返回数字x截断为y位小数的结果(保留多少位小数，没有的不添加0进行补全)
mysql> select TRUNCATE(3.5664,3),TRUNCATE(1.63735,2),TRUNCATE(3,2)from DUAL;
+--------------------+---------------------+---------------+
| TRUNCATE(3.5664,3) | TRUNCATE(1.63735,2) | TRUNCATE(3,2) |
+--------------------+---------------------+---------------+
|              3.566 |                1.63 |             3 |
+--------------------+---------------------+---------------+

#SQRT(x) 返回x的平方根。当X的值为负数时，返回NULL
mysql> select SQRT(4),SQRT(3),SQRT(-4)from DUAL;
+---------+--------------------+----------+
| SQRT(4) | SQRT(3)            | SQRT(-4) |
+---------+--------------------+----------+
|       2 | 1.7320508075688772 |     NULL |
+---------+--------------------+----------+

```



### 6.2.2 角度与弧度函数

| 函数名     | 用法                                  |
| ---------- | ------------------------------------- |
| RADIANS(x) | 将角度转化为弧度，其中，参数x为角度值 |
| DEGREES(x) | 将弧度转化为角度，其中，参数x为弧度值 |

```sql
mysql> SELECT RADIANS(30),RADIANS(45),RADIANS(60),RADIANS(90),DEGREES(2*PI()),DEGREES(RADIANS(60))FROM DUAL;
+--------------------+--------------------+--------------------+--------------------+-----------------+----------------------+
| RADIANS(30)        | RADIANS(45)        | RADIANS(60)        | RADIANS(90)        | DEGREES(2*PI()) | DEGREES(RADIANS(60)) |
+--------------------+--------------------+--------------------+--------------------+-----------------+----------------------+
| 0.5235987755982988 | 0.7853981633974483 | 1.0471975511965976 | 1.5707963267948966 |             360 |    59.99999999999999 |
+--------------------+--------------------+--------------------+--------------------+-----------------+----------------------+
```



### 6.2.3 三角函数

| 函数       | 用法                                                         |
| ---------- | ------------------------------------------------------------ |
| SIN(x)     | 返回x的正弦值，其中，参数x为弧度值                           |
| ASIN(x)    | 返回x的反正弦值，即获取正弦为x的值。如果x的值不在-1到1之间，则返回NULL |
| COS(x)     | 返回x的余弦值，其中，参数x为弧度值                           |
| ACOS(x)    | 返回x的反余弦值，即获取余弦为x的值。如果x的值不在-1到1之间，则返回NULL |
| TAN(x)     | 返回x的正切值，其中，参数x为弧度值                           |
| ATAN(x)    | 返回x的反正切值，即返回正切值为x的值                         |
| ATAN2(m,n) | 返回两个参数的反正切值                                       |
| COT(x)     | 返回x的余切值，其中，X为弧度值                               |

```sql
#三角函数
mysql> SELECT SIN(RADIANS(30)),DEGREES(ASIN(1)),TAN(RADIANS(45)),DEGREES(ATAN(1))FROM DUAL;
+---------------------+------------------+--------------------+------------------+
| SIN(RADIANS(30))    | DEGREES(ASIN(1)) | TAN(RADIANS(45))   | DEGREES(ATAN(1)) |
+---------------------+------------------+--------------------+------------------+
| 0.49999999999999994 |               90 | 0.9999999999999999 |               45 |
+---------------------+------------------+--------------------+------------------+
```



### 6.2.4 指数函数

| 函数          | 用法                                                 |
| ------------- | ---------------------------------------------------- |
| POW(x,y)      | 返回x的y次方                                         |
| EXP(X)        | 返回e的X次方，其中e是一个常数，2.718281828459045     |
| LN(X)，LOG(X) | 返回以e为底的X的对数，当X <= 0 时，返回的结果为NULL  |
| LOG10(X)      | 返回以10为底的X的对数，当X <= 0 时，返回的结果为NULL |
| LOG2(X)       | 返回以2为底的X的对数，当X <= 0 时，返回NULL          |

```sql
#指数和对数
mysql> SELECT POW(2,5),POWER(2,4),EXP(2)FROM DUAL;
+----------+------------+------------------+
| POW(2,5) | POWER(2,4) | EXP(2)           |
+----------+------------+------------------+
|       32 |         16 | 7.38905609893065 |
+----------+------------+------------------+

mysql> SELECT LN(EXP(2)),LOG(EXP(2)),LOG10(10),LOG2(4)FROM DUAL;
+------------+-------------+-----------+---------+
| LN(EXP(2)) | LOG(EXP(2)) | LOG10(10) | LOG2(4) |
+------------+-------------+-----------+---------+
|          2 |           2 |         1 |       2 |
+------------+-------------+-----------+---------+
```



### 6.2.5 进制间的转换

| 函数          | 用法                     |
| ------------- | ------------------------ |
| BIN(x)        | 返回x的二进制编码        |
| HEX(x)        | 返回x的十六进制编码      |
| OCT(x)        | 返回x的八进制编码        |
| CONV(x,f1,f2) | 返回f1进制数变成f2进制数 |

```sql
#进制间的转换
mysql> SELECT BIN(10),HEX(10),OCT(10),CONV(10,10,8)FROM DUAL;
+---------+---------+---------+---------------+
| BIN(10) | HEX(10) | OCT(10) | CONV(10,10,8) |
+---------+---------+---------+---------------+
| 1010    | A       | 12      | 12            |
+---------+---------+---------+---------------+
```



## 6.3 字符串函数

| 函数                             | 用法                                                         |
| -------------------------------- | ------------------------------------------------------------ |
| ASCII(S)                         | 返回字符串S中的第一个字符的ASCII码值                         |
| CHAR_LENGTH(s)                   | 返回字符串s的字符数。作用与CHARACTER_LENGTH(s)相同           |
| LENGTH(s)                        | 返回字符串s的字节数，和字符集有关                            |
| CONCAT(s1,s2,......,sn)          | 连接s1,s2,......,sn为一个字符串                              |
| CONCAT_WS(x,s1,s2,......,sn)     | 同CONCAT(s1,s2,...)函数，但是每个字符串之间要加上x           |
| INSERT(str, idx, len,replacestr) | 将字符串str从第idx位置开始，len个字符长的子串替换为字符串replacestr |
| REPLACE(str, a, b)               | 用字符串b替换字符串str中所有出现的字符串a                    |
| UPPER(s) 或 UCASE(s)             | 将字符串s的所有字母转成大写字母                              |
| LOWER(s) 或LCASE(s)              | 将字符串s的所有字母转成小写字母                              |
| LEFT(str,n)                      | 返回字符串str最左边的n个字符                                 |
| RIGHT(str,n)                     | 返回字符串str最右边的n个字符                                 |
| LPAD(str, len, pad)              | 用字符串pad对str最左边进行填充，直到str的长度为len个字符     |
| RPAD(str ,len, pad)              | 用字符串pad对str最右边进行填充，直到str的长度为len个字符     |
| LTRIM(s)                         | 去掉字符串s左侧的空格                                        |
| RTRIM(s)                         | 去掉字符串s右侧的空格                                        |
| TRIM(s)                          | 去掉字符串s开始与结尾的空格                                  |
| TRIM(s1 FROM s)                  | 去掉字符串s开始与结尾的s1                                    |
| TRIM(LEADING s1 FROM s)          | 去掉字符串s开始处的s1                                        |
| TRIM(TRAILING s1 FROM s)         | 去掉字符串s结尾处的s1                                        |
| REPEAT(str, n)                   | 返回str重复n次的结果                                         |
| SPACE(n)                         | 返回n个空格                                                  |
| STRCMP(s1,s2)                    | 比较字符串s1,s2的ASCII码值的大小                             |
| SUBSTR(s,index,len)              | 返回从字符串s的index位置其len个字符，作用与SUBSTRING(s,n,len)、MID(s,n,len)相同 |
| LOCATE(substr,str)               | 返回字符串substr在字符串str中首次出现的位置，作用于POSITION(substrIN str)、INSTR(str,substr)相同。未找到，返回0 |
| ELT(m,s1,s2,…,sn)                | 返回指定位置的字符串，如果m=1，则返回s1，如果m=2，则返回s2，如果m=n，则返回sn |
| FIELD(s,s1,s2,…,sn)              | 返回字符串s在字符串列表中第一次出现的位置                    |
| FIND_IN_SET(s1,s2)               | 返回字符串s1在字符串s2中出现的位置。其中，字符串s2是一个以逗号分隔的字符串 |
| REVERSE(s)                       | 返回s反转后的字符串                                          |
| NULLIF(value1,value2)            | 比较两个字符串，如果value1与value2相等，则返回NULL，否则返回value1 |

```sql
#ASCII(S) 返回字符串S中的第一个字符的ASCII码值
#CHAR_LENGTH(s) 返回字符串s的字符数。作用与CHARACTER_LENGTH(s)相同
#LENGTH(s) 返回字符串s的字节数（bit占位），和字符集有关
mysql> SELECT ASCII('Abcdfsf'),CHAR_LENGTH('hello'),CHAR_LENGTH('我们'),LENGTH('hello'),LENGTH('我们')FROM DUAL;
+------------------+----------------------+---------------------+-----------------+----------------+
| ASCII('Abcdfsf') | CHAR_LENGTH('hello') | CHAR_LENGTH('我们') | LENGTH('hello') | LENGTH('我们') |
+------------------+----------------------+---------------------+-----------------+----------------+
|               65 |                    5 |                   2 |               5 |              4 |
+------------------+----------------------+---------------------+-----------------+----------------+

# CONCAT(s1,s2,......,sn) 连接s1,s2,......,sn为一个字符串
mysql> SELECT CONCAT(emp.last_name,' worked for ',mgr.last_name) "details"
    -> FROM employees emp JOIN employees mgr
    -> WHERE emp.`manager_id` = mgr.employee_id;
+--------------------------------+
| details                        |
+--------------------------------+
| Kochhar worked for King        |
| De Haan worked for King        |
| Hunold worked for De Haan      |
| Ernst worked for Hunold        |
| Austin worked for Hunold       |

#CONCAT_WS(x,s1,s2,......,sn)同CONCAT(s1,s2,...)函数，但是每个字符串之间要加上x
mysql> SELECT CONCAT_WS('-','hello','world','hello','beijing')
    -> FROM DUAL;
+--------------------------------------------------+
| CONCAT_WS('-','hello','world','hello','beijing') |
+--------------------------------------------------+
| hello-world-hello-beijing                        |
+--------------------------------------------------


#字符串的索引是从1开始的！
#INSERT(str, idx, len,replacestr)将字符串str从第idx位置开始，len个字符长的子串替换为字符串replacestr
#REPLACE(str, a, b)用字符串b替换字符串str中所有出现的字符串a
mysql> SELECT INSERT('helloworld',2,3,'aaaaa'),REPLACE('hello','lol','mmm')
    -> FROM DUAL;
+----------------------------------+------------------------------+
| INSERT('helloworld',2,3,'aaaaa') | REPLACE('hello','lol','mmm') |
+----------------------------------+------------------------------+
| haaaaaoworld                     | hello                        |
+----------------------------------+------------------------------+

#UPPER(s) 或 UCASE(s) 将字符串s的所有字母转成大写字母
#LOWER(s) 或LCASE(s) 将字符串s的所有字母转成小写字母
#
mysql> SELECT UPPER('HelLo'),LOWER('HelLo')FROM DUAL;
+----------------+----------------+
| UPPER('HelLo') | LOWER('HelLo') |
+----------------+----------------+
| HELLO          | hello          |
+----------------+----------------+

#mysql windows版本对大小写不敏感，所以这样查会忽略大小写，都会查到King的记录
SELECT last_name,salary FROM employees WHERE LOWER(last_name) = 'KIng';

#LEFT(str,n) 返回字符串str最左边的n个字符
#RIGHT(str,n) 返回字符串str最右边的n个字符
mysql> SELECT LEFT('hello',2),RIGHT('hello',3),RIGHT('hello',13) FROM DUAL;
+-----------------+------------------+-------------------+
| LEFT('hello',2) | RIGHT('hello',3) | RIGHT('hello',13) |
+-----------------+------------------+-------------------+
| he              | llo              | hello             |
+-----------------+------------------+-------------------+

# LPAD:实现右对齐效果
# RPAD:实现左对齐效果
#LPAD(str, len, pad) 用字符串pad对str最左边进行填充，直到str的长度为len个字符
#RPAD(str ,len, pad) 用字符串pad对str最右边进行填充，直到str的长度为len个字符
mysql> SELECT employee_id,last_name,LPAD(salary,10,' ') FROM employees;
+-------------+-------------+---------------------+
| employee_id | last_name   | LPAD(salary,10,' ') |
+-------------+-------------+---------------------+
|         100 | King        |   24000.00          |
|         101 | Kochhar     |   17000.00          |
|         102 | De Haan     |   17000.00          |
|         103 | Hunold      |    9000.00          |;

#LTRIM(s) 去掉字符串s左侧的空格
#RTRIM(s) 去掉字符串s右侧的空格
#TRIM(s) 去掉字符串s开始与结尾的空格
#TRIM(s1 FROM s) 去掉字符串s开始与结尾的s1
#TRIM(LEADING s1 FROM s)去掉字符串s开始处的s1
#TRIM(TRAILING s1 FROM s)去掉字符串s结尾处的s1
mysql> SELECT CONCAT('---',LTRIM('    h  el  lo   '),'***'),TRIM('o' FROM 'ooheollo') FROM DUAL;
+-----------------------------------------------+---------------------------+
| CONCAT('---',LTRIM('    h  el  lo   '),'***') | TRIM('o' FROM 'ooheollo') |
+-----------------------------------------------+---------------------------+
| ---h  el  lo   ***                            | heoll                     |
+-----------------------------------------------+---------------------------+

#REPEAT(str, n) 返回str重复n次的结果
#SPACE(n) 返回n个空格
#STRCMP(s1,s2) 比较字符串s1,s2的ASCII码值的大小
mysql> SELECT REPEAT('hello',4),LENGTH(SPACE(5)),STRCMP('abc','abe')FROM DUAL;
+----------------------+------------------+---------------------+
| REPEAT('hello',4)    | LENGTH(SPACE(5)) | STRCMP('abc','abe') |
+----------------------+------------------+---------------------+
| hellohellohellohello |                5 |                  -1 |
+----------------------+------------------+---------------------+

#SUBSTR(s,index,len)返回从字符串s的index位置其len个字符，作用与SUBSTRING(s,n,len)、MID(s,n,len)相同
#LOCATE(substr,str)返回字符串substr在字符串str中首次出现的位置，作用于POSITION(substr IN str)、INSTR(str,substr)相同。未找到，返回0
mysql> SELECT SUBSTR('hello',2,2),LOCATE('ll','hello') FROM DUAL;
+---------------------+----------------------+
| SUBSTR('hello',2,2) | LOCATE('ll','hello') |
+---------------------+----------------------+
| el                  |                    3 |
+---------------------+----------------------+

#ELT(m,s1,s2,…,sn)返回指定位置的字符串，如果m=1，则返回s1，如果m=2，则返回s2，如果m=n，则返回sn,m>n时返回NULL，
#FIELD(s,s1,s2,…,sn) 返回字符串s在字符串列表中第一次出现的位置
FIND_IN_SET(s1,s2)返回字符串s1在字符串s2中出现的位置。其中，字符串s2是一个以逗号分隔的字符串
mysql> SELECT ELT(2,'a','b','c','d'),FIELD('mm','gg','jj','mm','dd','mm'),FIND_IN_SET('mm','gg,mm,jj,dd,mm,gg')FROM DUAL;
+------------------------+--------------------------------------+---------------------------------------+
| ELT(2,'a','b','c','d') | FIELD('mm','gg','jj','mm','dd','mm') | FIND_IN_SET('mm','gg,mm,jj,dd,mm,gg') |
+------------------------+--------------------------------------+---------------------------------------+
| b                      |                                    3 |                                     2 |
+------------------------+--------------------------------------+---------------------------------------+

#REVERSE(s) 返回s反转后的字符串
#NULLIF(value1,value2)比较两个字符串，如果value1与value2相等，则返回NULL，否则返回

mysql> SELECT REVERSE('ABC'),NULLIF('abc','abc'),NULLIF('ABC','abc'),NULLIF('ABV','AC') FROM DUAL;
+----------------+---------------------+---------------------+--------------------+
| REVERSE('ABC') | NULLIF('abc','abc') | NULLIF('ABC','abc') | NULLIF('ABV','AC') |
+----------------+---------------------+---------------------+--------------------+
| CBA            | NULL                | NULL                | ABV                |
+----------------+---------------------+---------------------+--------------------+
```



## 6.4 日期和时间函数

### 6.4.1获取日期、时间

| 函数                                                         | 用法                           |
| ------------------------------------------------------------ | ------------------------------ |
| CURDATE() ，CURRENT_DATE()                                   | 返回当前日期，只包含年、月、日 |
| CURTIME() ， CURRENT_TIME()                                  | 返回当前时间，只包含时、分、秒 |
| NOW() / SYSDATE() / CURRENT_TIMESTAMP() / LOCALTIME() /LOCALTIMESTAMP() | 返回当前系统日期和时间         |
| UTC_DATE()                                                   | 返回UTC（世界标准时间）日期    |
| UTC_TIME()                                                   | 返回UTC（世界标准时间）时间    |

```sql
mysql> SELECT CURDATE(),CURRENT_DATE(),CURTIME(),NOW(),SYSDATE(),
    -> UTC_DATE(),UTC_TIME()
    -> FROM DUAL;
+------------+----------------+-----------+---------------------+---------------------+------------+------------+
| CURDATE()  | CURRENT_DATE() | CURTIME() | NOW()               | SYSDATE()           | UTC_DATE() | UTC_TIME() |
+------------+----------------+-----------+---------------------+---------------------+------------+------------+
| 2023-04-12 | 2023-04-12     | 21:12:28  | 2023-04-12 21:12:28 | 2023-04-12 21:12:28 | 2023-04-12 | 13:12:28   |
+------------+----------------+-----------+---------------------+---------------------+------------+------------+

#加0后会转换为数字,再进行加减
mysql> SELECT CURDATE(),CURDATE() + 0,CURTIME() + 0,NOW() + 0
    -> FROM DUAL;
+------------+---------------+---------------+----------------+
| CURDATE()  | CURDATE() + 0 | CURTIME() + 0 | NOW() + 0      |
+------------+---------------+---------------+----------------+
| 2023-04-12 |      20230412 |        211406 | 20230412211406 |
+------------+---------------+---------------+----------------+
```



### 6.4.2 日期与时间戳的转换

| 函数                     | 用法                                                         |
| ------------------------ | ------------------------------------------------------------ |
| UNIX_TIMESTAMP()         | 以UNIX时间戳的形式返回当前时间。SELECT UNIX_TIMESTAMP() ->1634348884 |
| UNIX_TIMESTAMP(date)     | 将时间date以UNIX时间戳的形式返回。                           |
| FROM_UNIXTIME(timestamp) | 将UNIX时间戳的时间转换为普通格式的时间                       |

```sql
#时间戳转换
mysql> SELECT UNIX_TIMESTAMP(),UNIX_TIMESTAMP('2021-10-01 12:12:32'),FROM_UNIXTIME(1635173853),FROM_UNIXTIME(1633061552) FROM DUAL;
+------------------+---------------------------------------+---------------------------+---------------------------+
| UNIX_TIMESTAMP() | UNIX_TIMESTAMP('2021-10-01 12:12:32') | FROM_UNIXTIME(1635173853) | FROM_UNIXTIME(1633061552) |
+------------------+---------------------------------------+---------------------------+---------------------------+
|       1681305378 |                            1633061552 | 2021-10-25 22:57:33       | 2021-10-01 12:12:32       |
+------------------+---------------------------------------+---------------------------+---------------------------+
```



### 6.4.3获取月份、星期、星期数、天数等函数

| 函数                                    | 用法                                            |
| --------------------------------------- | ----------------------------------------------- |
| YEAR(date) / MONTH(date) / DAY(date)    | 返回具体的日期值                                |
| HOUR(time) / MINUTE(time) /SECOND(time) | 返回具体的时间值                                |
| MONTHNAME(date)                         | 返回月份：January，...                          |
| DAYNAME(date)                           | 返回星期几：MONDAY，TUESDAY.....SUNDAY          |
| WEEKDAY(date)                           | 返回周几，注意，周1是0，周2是1，。。。周日是6   |
| QUARTER(date)                           | 返回日期对应的季度，范围为1～4                  |
| WEEK(date) ， WEEKOFYEAR(date)          | 返回一年中的第几周                              |
| DAYOFYEAR(date)                         | 返回日期是一年中的第几天                        |
| DAYOFMONTH(date)                        | 返回日期位于所在月份的第几天                    |
| DAYOFWEEK(date)                         | 返回周几，注意：周日是1，周一是2，。。。周六是7 |

```sql
#获取年月日，执行的时间是 2023-04-12 21:17:48
mysql> SELECT YEAR(CURDATE()),MONTH(CURDATE()),DAY(CURDATE()),HOUR(CURTIME()),MINUTE(NOW()),SECOND(SYSDATE())FROM DUAL;
+-----------------+------------------+----------------+-----------------+---------------+-------------------+
| YEAR(CURDATE()) | MONTH(CURDATE()) | DAY(CURDATE()) | HOUR(CURTIME()) | MINUTE(NOW()) | SECOND(SYSDATE()) |
+-----------------+------------------+----------------+-----------------+---------------+-------------------+
|            2023 |                4 |             12 |              21 |            17 |                48 |
+-----------------+------------------+----------------+-----------------+---------------+-------------------+

#获取月份、星期几
mysql> SELECT MONTHNAME(NOW()) '月份',DAYNAME(NOW() ) '星期几',WEEKDAY(NOW()) '这个星期的第几天',QUARTER(CURDATE()) '季度',WEEK(CURDATE()) '第几周',DAYOFYEAR(NOW()) '今年第几天',DAYOFMONTH(NOW()) '当月第几天',DAYOFWEEK(NOW()) '本周第几天'FROM DUAL;
+-------+-----------+------------------+------+--------+------------+------------+------------+
| 月份  | 星期几    | 这个星期的第几天 | 季度 | 第几周 | 今年第几天 | 当月第几天 | 本周第几天 |
+-------+-----------+------------------+------+--------+------------+------------+------------+
| April | Wednesday |                2 |    2 |     15 |        102 |         12 |          4 |
+-------+-----------+------------------+------+--------+------------+------------+------------+
```



### 6.4.4 日期的操作函数

| 函数                    | 用法                                       |
| ----------------------- | ------------------------------------------ |
| EXTRACT(type FROM date) | 返回指定日期中特定的部分，type指定返回的值 |

EXTRACT(type FROM date)函数中type的取值与含义：

![image-20230412213146206](.\date-quzhi.png)

```sql
#现在是2023-04-12 21:33:03
mysql> SELECT EXTRACT(SECOND FROM NOW()) '当前时间的秒',EXTRACT(DAY FROM NOW()) '当前时间的日期',EXTRACT(HOUR_MINUTE FROM NOW()) '当前时间的小时和分钟',EXTRACT(QUARTER FROM '2021-05-12') '当前时间的季度'FROM DUAL;
+--------------+----------------+----------------------+----------------+
| 当前时间的秒 | 当前时间的日期 | 当前时间的小时和分钟 | 当前时间的季度 |
+--------------+----------------+----------------------+----------------+
|            3 |             12 |                 2133 |              2 |
+--------------+----------------+----------------------+----------------+
```



### 6.4.5 时间和秒钟转换的函数

| 函数                 | 用法                                                         |
| :------------------- | ------------------------------------------------------------ |
| TIME_TO_SEC(time)    | 将 time 转化为秒并返回结果值。转化的公式为： 小时X3600+分钟X60+秒 |
| SEC_TO_TIME(seconds) | 将 seconds 描述转化为包含小时、分钟和秒的时间                |

```sql
mysql> SELECT TIME_TO_SEC(CURTIME()),SEC_TO_TIME(83355)FROM DUAL;
+------------------------+--------------------+
| TIME_TO_SEC(CURTIME()) | SEC_TO_TIME(83355) |
+------------------------+--------------------+
|                  77663 | 23:09:15           |
+------------------------+--------------------+
```



### 6.4.6 计算日期和时间的函数

| 函数                                                         | 用法                                                         |
| :----------------------------------------------------------- | ------------------------------------------------------------ |
| DATE_ADD(datetime, INTERVAL expr type)，ADDDATE(date,INTERVAL expr type) | 返回与给定日期时间相差INTERVAL时间段的日期时间               |
| DATE_SUB(date,INTERVAL expr type)，SUBDATE(date,INTERVAL expr type) | 返回与date相差INTERVAL时间间隔的日期                         |
| ADDTIME(time1,time2)                                         | 返回time1加上time2的时间。当time2为一个数字时，代表的是秒，可以为负数 |
| SUBTIME(time1,time2)                                         | 返回time1减去time2后的时间。当time2为一个数字时，代表的是秒，可以为负数 |
| DATEDIFF(date1,date2)                                        | 返回date1 - date2的日期间隔天数                              |
| TIMEDIFF(time1, time2)                                       | 返回time1 - time2的时间间隔                                  |
| FROM_DAYS(N)                                                 | 返回从0000年1月1日起，N天以后的日期                          |
| TO_DAYS(date)                                                | 返回日期date距离0000年1月1日的天数                           |
| LAST_DAY(date)                                               | 返回date所在月份的最后一天的日期                             |
| MAKEDATE(year,n)                                             | 针对给定年份与所在年份中的天数返回一个日期                   |
| MAKETIME(hour,minute,second)                                 | 将给定的小时、分钟和秒组合成时间并返回                       |
| PERIOD_ADD(time,n)                                           | 返回time加上n后的时间                                        |

```sql
#计算时间
#DATE_ADD(datetime, INTERVAL expr type)，ADDDATE(date,INTERVAL expr type)返回与给定日期时间相差INTERVAL时间段的日期时间
#DATE_SUB(date,INTERVAL expr type)，SUBDATE(date,INTERVAL expr type)返回与date相差INTERVAL时间间隔的日期

mysql> SELECT NOW(),DATE_ADD(NOW(),INTERVAL 1 YEAR),DATE_ADD(NOW(),INTERVAL -1 YEAR),DATE_SUB(NOW(),INTERVAL 1 YEAR)FROM DUAL;
+---------------------+---------------------------------+----------------------------------+---------------------------------+
| NOW()               | DATE_ADD(NOW(),INTERVAL 1 YEAR) | DATE_ADD(NOW(),INTERVAL -1 YEAR) | DATE_SUB(NOW(),INTERVAL 1 YEAR) |
+---------------------+---------------------------------+----------------------------------+---------------------------------+
| 2023-04-12 21:35:19 | 2024-04-12 21:35:19             | 2022-04-12 21:35:19              | 2022-04-12 21:35:19             |
+---------------------+---------------------------------+----------------------------------+---------------------------------+

mysql> SELECT DATE_ADD(NOW(), INTERVAL 1 DAY) AS col1,DATE_ADD('2021-10-21 23:32:12',INTERVAL 1 SECOND) AS col2,
    -> ADDDATE('2021-10-21 23:32:12',INTERVAL 1 SECOND) AS col3,
    -> DATE_ADD('2021-10-21 23:32:12',INTERVAL '1_1' MINUTE_SECOND) AS col4,
    -> DATE_ADD(NOW(), INTERVAL -1 YEAR) AS col5, #可以是负数
    -> DATE_ADD(NOW(), INTERVAL '1_1' YEAR_MONTH) AS col6 #需要单引号
    -> FROM DUAL;
+---------------------+---------------------+---------------------+---------------------+---------------------+---------------------+
| col1                | col2                | col3                | col4                | col5                | col6                |
+---------------------+---------------------+---------------------+---------------------+---------------------+---------------------+
| 2023-04-13 21:38:48 | 2021-10-21 23:32:13 | 2021-10-21 23:32:13 | 2021-10-21 23:33:13 | 2022-04-12 21:38:48 | 2024-05-12 21:38:48 |
+---------------------+---------------------+---------------------+---------------------+---------------------+---------------------+


#时间差值

mysql> SELECT NOW()'当前时间',ADDTIME(NOW(),20) '当前时间加20秒',SUBTIME(NOW(),30) '当前时间减30秒',SUBTIME(NOW(),'1:1:3')'当前时间减1小时1分3秒',DATEDIFF(NOW(),'2021-10-01') '当前时间与2021-10-01相差天数'FROM DUAL;
+---------------------+---------------------+---------------------+-----------------------+------------------------------+
| 当前时间            | 当前时间加20秒      | 当前时间减30秒      | 当前时间减1小时1分3秒 | 当前时间与2021-10-01相差天数 |
+---------------------+---------------------+---------------------+-----------------------+------------------------------+
| 2023-04-12 21:44:00 | 2023-04-12 21:44:20 | 2023-04-12 21:43:30 | 2023-04-12 20:42:57   |                          558 |
+---------------------+---------------------+---------------------+-----------------------+------------------------------+


mysql> SELECT  NOW()'当前时间',TIMEDIFF(NOW(),'2021-10-25 22:10:10') '当前时间与2021-10-25时间差',FROM_DAYS(366)'0000年后的时间',TO_DAYS('0000-12-25') '返回日期date距离0000年1月1日的天数',LAST_DAY(NOW())'返回当前时间的最后一天日期',MAKEDATE(YEAR(NOW()),32),MAKETIME(10,21,23),PERIOD_ADD(20200101010101,10) FROM DUAL;
+---------------------+----------------------------+----------------+------------------------------------+----------------------------+--------------------------+--------------------+-------------------------------+
| 当前时间            | 当前时间与2021-10-25时间差 | 0000年后的时间 | 返回日期date距离0000年1月1日的天数 | 返回当前时间的最后一天日期 | MAKEDATE(YEAR(NOW()),32) | MAKETIME(10,21,23) | PERIOD_ADD(20200101010101,10) |
+---------------------+----------------------------+----------------+------------------------------------+----------------------------+--------------------------+--------------------+-------------------------------+
| 2023-04-12 21:49:31 | 838:59:59                  | 0001-01-01     |                                359 | 2023-04-30                 | 2023-02-01               | 10:21:23           |                20200101010111 |
+---------------------+----------------------------+----------------+------------------------------------+----------------------------+--------------------------+--------------------+-------------------------------+

```



### 6.4.7 日期的格式化与解析

| 函数                              | 用法                                       |
| --------------------------------- | ------------------------------------------ |
| DATE_FORMAT(date,fmt)             | 按照字符串fmt格式化日期date值              |
| TIME_FORMAT(time,fmt)             | 按照字符串fmt格式化日期date值              |
| GET_FORMAT(date_type,format_type) | 返回日期字符串的显示格式                   |
| STR_TO_DATE(str, fmt)             | 按照字符串fmt对str进行解析，解析为一个日期 |

| 格式符 | 说明                                                        | 格式符 | 说明                                                        |
| ------ | ----------------------------------------------------------- | ------ | ----------------------------------------------------------- |
| %Y     | 4位数字表示年份                                             | %y     | 表示两位数字表示年份                                        |
| %M     | 月名表示月份（January,....）                                | %m     | 两位数字表示月份（01,02,03。。。）                          |
| %b     | 缩写的月名（Jan.，Feb.，....）                              | %c     | 数字表示月份（1,2,3,...）                                   |
| %D     | 英文后缀表示月中的天数（1st,2nd,3rd,...）                   | %d     | 两位数字表示月中的天数(01,02...)                            |
| %e     | 数字形式表示月中的天数（1,2,3,4,5.....）                    |        |                                                             |
| %H     | 两位数字表示小数，24小时制（01,02..）                       | %h和%I | 两位数字表示小时，12小时制（01,02..）                       |
| %k     | 数字形式的小时，24小时制(1,2,3)                             | %l     | 数字形式表示小时，12小时制（1,2,3,4....）                   |
| %i     | 两位数字表示分钟（00,01,02）                                | %S和%s | 两位数字表示秒(00,01,02...)                                 |
| %W     | 一周中的星期名称（Sunday...）                               | %a     | 一周中的星期缩写（Sun.，Mon.,Tues.，..）                    |
| %w     | 以数字表示周中的天数(0=Sunday,1=Monday....)                 |        |                                                             |
| %j     | 以3位数字表示年中的天数(001,002...)                         | %U     | 以数字表示年中的第几周，（1,2,3。。）其中Sunday为周中第一天 |
| %u     | 以数字表示年中的第几周，（1,2,3。。）其中Monday为周中第一天 |        |                                                             |
| %T     | 24小时制                                                    | %r     | 12小时制                                                    |
| %p     | AM或PM                                                      | %%     | 表示%                                                       |

```sql
# 日期的格式化与解析
# 格式化：日期 ---> 字符串
# 解析：  字符串 ----> 日期

#此时我们谈的是日期的显式格式化和解析

#之前，我们接触过隐式的格式化或解析
SELECT * FROM employees WHERE hire_date = '1993-01-13';

#格式化：
SELECT DATE_FORMAT(CURDATE(),'%Y-%M-%D'),DATE_FORMAT(NOW(),'%Y-%m-%d'),TIME_FORMAT(CURTIME(),'%h:%i:%S'),DATE_FORMAT(NOW(),'%Y-%M-%D %h:%i:%S %W %w %T %r')
FROM DUAL;
+-----------------------------------+-------------------------------+-----------------------------------+-----------------------------------------------------------+
| DATE_FORMAT(CURDATE(),'%Y-%M-%D') | DATE_FORMAT(NOW(),'%Y-%m-%d') | TIME_FORMAT(CURTIME(),'%h:%i:%S') | DATE_FORMAT(NOW(),'%Y-%M-%D %h:%i:%S %W %w %T %r')        |
+-----------------------------------+-------------------------------+-----------------------------------+-----------------------------------------------------------+
| 2023-April-12th                   | 2023-04-12                    | 09:52:43                          | 2023-April-12th 09:52:43 Wednesday 3 21:52:43 09:52:43 PM |
+-----------------------------------+-------------------------------+-----------------------------------+-----------------------------------------------------------+

#解析：格式化的逆过程
SELECT STR_TO_DATE('2021-October-25th 11:37:30 Monday 1','%Y-%M-%D %h:%i:%S %W %w')
FROM DUAL;
+------------------------------------------------------------------------------+
| STR_TO_DATE('2021-October-25th 11:37:30 Monday 1','%Y-%M-%D %h:%i:%S %W %w') |
+------------------------------------------------------------------------------+
| 2021-10-25 11:37:30                                                          |
+------------------------------------------------------------------------------+

#获取地区的格式
SELECT GET_FORMAT(DATE,'USA')
FROM DUAL;
+------------------------+
| GET_FORMAT(DATE,'USA') |
+------------------------+
| %m.%d.%Y               |
+------------------------+

SELECT DATE_FORMAT(CURDATE(),GET_FORMAT(DATE,'USA'))
FROM DUAL;
+-----------------------------------------------+
| DATE_FORMAT(CURDATE(),GET_FORMAT(DATE,'USA')) |
+-----------------------------------------------+
| 04.12.2023                                    |
+-----------------------------------------------+
```



## 6.5 流程控制函数

| 函数                                                         | 用法                                            |
| ------------------------------------------------------------ | ----------------------------------------------- |
| IF(value,value1,value2)                                      | 如果value的值为TRUE，返回value1，否则返回value2 |
| IFNULL(value1, value2)                                       | 如果value1不为NULL，返回value1，否则返回value2  |
| CASE WHEN 条件1 THEN 结果1 WHEN 条件2 THEN 结果2.... [ELSE resultn] END | 相当于Java的if...else if...else...              |
| CASE expr WHEN 常量值1 THEN 值1 WHEN 常量值1 THEN值1 .... [ELSE 值n] END | 相当于Java的switch...case...                    |

```sql
#IF(value,value1,value2)
mysql> SELECT last_name,salary,IF(salary >= 6000,'高工资','低工资') "details"
    -> FROM employees;
+-------------+----------+---------+
| last_name   | salary   | details |
+-------------+----------+---------+
| King        | 24000.00 | 高工资  |
| Kochhar     | 17000.00 | 高工资  |
| De Haan     | 17000.00 | 高工资  |
| Hunold      |  9000.00 | 高工资  |
| Ernst       |  6000.00 | 高工资  |
| Austin      |  4800.00 | 低工资  |
| Pataballa   |  4800.00 | 低工资  |


#IFNULL(value1, value2)
SELECT last_name,commission_pct,IFNULL(commission_pct,0) "details"
FROM employees;
+-------------+----------------+---------+
| last_name   | commission_pct | details |
+-------------+----------------+---------+
| Davies      |           NULL |    0.00 |
| Matos       |           NULL |    0.00 |
| Vargas      |           NULL |    0.00 |
| Russell     |           0.40 |    0.40 |
| Partners    |           0.30 |    0.30 |

#CASE WHEN ... THEN ...WHEN ... THEN ... ELSE ... END
mysql> SELECT last_name,salary,CASE WHEN salary >= 15000 THEN '白骨精'
    ->      WHEN salary >= 10000 THEN '潜力股'
    ->      WHEN salary >= 8000 THEN '小屌丝'
    ->      ELSE '草根' END "details",department_id
    -> FROM employees;
+-------------+----------+---------+---------------+
| last_name   | salary   | details | department_id |
+-------------+----------+---------+---------------+
| King        | 24000.00 | 白骨精  |            90 |
| Kochhar     | 17000.00 | 白骨精  |            90 |
| De Haan     | 17000.00 | 白骨精  |            90 |
| Hunold      |  9000.00 | 小屌丝  |            60 |
| Ernst       |  6000.00 | 草根    |            60 |

#CASE expr  WHEN ... THEN ...WHEN ... THEN ... ELSE ... END
mysql> SELECT employee_id,last_name,department_id,salary,CASE department_id WHEN 10 THEN salary * 1.1
    ->      WHEN 20 THEN salary * 1.2
    ->      WHEN 30 THEN salary * 1.3
    ->      END "details"
    -> FROM employees
    -> WHERE department_id IN (10,20,30);
+-------------+------------+---------------+----------+----------+
| employee_id | last_name  | department_id | salary   | details  |
+-------------+------------+---------------+----------+----------+
|         200 | Whalen     |            10 |  4400.00 |  4840.00 |
|         201 | Hartstein  |            20 | 13000.00 | 15600.00 |
|         202 | Fay        |            20 |  6000.00 |  7200.00 |
|         114 | Raphaely   |            30 | 11000.00 | 14300.00 |
|         115 | Khoo       |            30 |  3100.00 |  4030.00 |
|         116 | Baida      |            30 |  2900.00 |  3770.00 |
|         117 | Tobias     |            30 |  2800.00 |  3640.00 |
|         118 | Himuro     |            30 |  2600.00 |  3380.00 |
|         119 | Colmenares |            30 |  2500.00 |  3250.00 |
+-------------+------------+---------------+----------+----------+
```



## 6.6 加密解密函数

| 函数                        | 用法                                                         |
| --------------------------- | ------------------------------------------------------------ |
| PASSWORD(str)               | 返回字符串str的加密版本，41位长的字符串。加密结果不可逆，常用于用户的密码加密 |
| MD5(str)                    | 返回字符串str的md5加密后的值，也是一种加密方式。若参数为NULL，则会返回NULL |
| SHA(str)                    | 从原明文密码str计算并返回加密后的密码字符串，当参数为NULL时，返回NULL。SHA加密算法比MD5更加安全。 |
| ENCODE(value,password_seed) | 返回使用password_seed作为加密密码加密value                   |
| DECODE(value,password_seed) | 返回使用password_seed作为加密密码解密value                   |

```sql
# PASSWORD()在mysql8.0中弃用。
SELECT MD5('mysql'),SHA('mysql'),MD5(MD5('mysql'))
FROM DUAL;
+----------------------------------+------------------------------------------+----------------------------------+
| MD5('mysql')                     | SHA('mysql')                             | MD5(MD5('mysql'))                |
+----------------------------------+------------------------------------------+----------------------------------+
| 81c3b080dad537de7e10e0987a4bf52e | f460c882a18c1304d88854e902e11b85d71e7e1b | 9b1c95c962f12d84f57c68e694274783 |
+----------------------------------+------------------------------------------+----------------------------------+
#ENCODE()\DECODE() 在mysql8.0中弃用。
```



## 6.7 MySQL信息函数

| 函数                                                  | 用法                                                     |
| ----------------------------------------------------- | -------------------------------------------------------- |
| VERSION()                                             | 返回当前MySQL的版本号                                    |
| CONNECTION_ID()                                       | 返回当前MySQL服务器的连接数                              |
| DATABASE()，SCHEMA()                                  | 返回MySQL命令行当前所在的数据库                          |
| USER()，CURRENT_USER()、SYSTEM_USER()，SESSION_USER() | 返回当前连接MySQL的用户名，返回结果格式为“主机名@用户名” |
| CHARSET(value)                                        | 返回字符串value自变量的字符集                            |
| COLLATION(value)                                      | 返回字符串value的比较规则                                |

```sql
mysql> SELECT VERSION(),CONNECTION_ID(),DATABASE(),SCHEMA(),
    -> USER(),CURRENT_USER(),CHARSET('你好'),COLLATION('你好')
    -> FROM DUAL;
+-----------+-----------------+------------+-----------+----------------+----------------+-----------------+-------------------+
| VERSION() | CONNECTION_ID() | DATABASE() | SCHEMA()  | USER()         | CURRENT_USER() | CHARSET('你好') | COLLATION('你好') |
+-----------+-----------------+------------+-----------+----------------+----------------+-----------------+-------------------+
| 8.0.26    |              10 | atguigudb  | atguigudb | root@localhost | root@localhost | gbk             | gbk_chinese_ci    |
+-----------+-----------------+------------+-----------+----------------+----------------+-----------------+-------------------
```



## 6.8 其他函数

|函数|用法|
|-------------------|-------------------|
|FORMAT(value,n)|返回对数字value进行格式化后的结果数据。n表示四舍五入后保留到小数点后n位|
|CONV(value,from,to)|将value的值进行不同进制之间的转换|
|INET_ATON(ipvalue)|将以点分隔的IP地址转化为一个数字|
|INET_NTOA(value)|将数字形式的IP地址转化为以点分隔的IP地址|
|BENCHMARK(n,expr)|将表达式expr重复执行n次。用于测试MySQL处理expr表达式所耗费的时间|
|CONVERT(value USINGchar_code)|将value所使用的字符编码修改为char_code|

```sql
#如果n的值小于或者等于0，则只保留整数部分
mysql> SELECT FORMAT(123.125,2),FORMAT(123.125,0),FORMAT(123.125,-2)
    -> FROM DUAL;
+-------------------+-------------------+--------------------+
| FORMAT(123.125,2) | FORMAT(123.125,0) | FORMAT(123.125,-2) |
+-------------------+-------------------+--------------------+
| 123.13            | 123               | 123                |
+-------------------+-------------------+--------------------+

mysql> SELECT CONV(16, 10, 2), CONV(8888,10,16), CONV(NULL, 10, 2)
    -> FROM DUAL;
+-----------------+------------------+-------------------+
| CONV(16, 10, 2) | CONV(8888,10,16) | CONV(NULL, 10, 2) |
+-----------------+------------------+-------------------+
| 10000           | 22B8             | NULL              |
+-----------------+------------------+-------------------

#以“192.168.1.100”为例，计算方式为192乘以256的3次方，加上168乘以256的2次方，加上1乘以256，再加上100。
mysql> SELECT INET_ATON('192.168.1.100'),INET_NTOA(3232235876)
    -> FROM DUAL;
+----------------------------+-----------------------+
| INET_ATON('192.168.1.100') | INET_NTOA(3232235876) |
+----------------------------+-----------------------+
|                 3232235876 | 192.168.1.100         |
+----------------------------+-----------------------+

#BENCHMARK()用于测试表达式的执行效率
SELECT BENCHMARK(100000,MD5('mysql'))
FROM DUAL;

# CONVERT():可以实现字符集的转换
mysql> SELECT CHARSET('CESHI'),CHARSET(CONVERT('CESHI' USING 'utf8')) FROM DUAL;
+------------------+----------------------------------------+
| CHARSET('CESHI') | CHARSET(CONVERT('CESHI' USING 'utf8')) |
+------------------+----------------------------------------+
| gbk              | utf8mb3                                |
+------------------+----------------------------------------+
```

